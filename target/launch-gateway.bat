@echo off
set cmd="C:\Program Files\Java\jdk1.7.0_75\jre\bin\java -Djava.net.preferIPv4Stack=true -cp .\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.assembly.version.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.bridge.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.itests.authentication.modules.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.license.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.management.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.server.api.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.server.demo.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.server.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.gateway.server.spi.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\com.kaazing.mina.netty.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\commons-cli-1.2.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\hazelcast-1.9.4.8.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\hazelcast-client-1.9.4.8.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\hazelcast-cloud-1.9.4.8.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\jdom-1.1.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\json-20090211.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\log4j-1.2.14.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\sigar.dist-1.6.4.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\slf4j-api-1.5.2.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\slf4j-log4j12-1.5.2.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\snmp4j-1.11.3.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\snmp4j-agent-1.4.3.jar;.\gateway\windows\kaazing-websocket-gateway-4.0.7\lib\xmlbeans-2.4.0.jar -DGATEWAY_HOME=D:\Kaazing\altHTML\html5.itests.gateway\target\gateway\windows\kaazing-websocket-gateway-4.0.7 -DGATEWAY_LOG_DIRECTORY=D:\Kaazing\altHTML\html5.itests.gateway\target\gateway\windows\kaazing-websocket-gateway-4.0.7\log -DGATEWAY_CONFIG=D:\Kaazing\altHTML\html5.itests.gateway\target\gateway\windows\kaazing-websocket-gateway-4.0.7\conf\gateway-config-client-itests.xml -Dgateway.hostname=localhost -Djava.library.path=D:\Kaazing\altHTML\html5.itests.gateway/target\gateway\windows\kaazing-websocket-gateway-4.0.7/lib/sigar com.kaazing.gateway.server.WindowsMain "
set tab=	
set dir=%~dp0
set something=nothing
set pid=0
SETLOCAL ENABLEDELAYEDEXPANSION
for /F "usebackq tokens=1,2 delims=;=%tab% " %%i in (`wmic process call create %cmd%^, "%dir%"`) do (
	set something="%%i"
	if /I "%%i" EQU "ProcessId" (
		if %%j GTR 0 echo %%j > ./target/gateway.pid
)
)
